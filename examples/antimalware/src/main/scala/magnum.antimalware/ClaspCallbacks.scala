package magnum.antimalware

import clasp.Emulator

// TODO: What's a good name for this?
class ClaspCallbacks {
  var profilingCallback: Option[(Emulator)=>Boolean] = None

  def registerProfilingCallback(callback: (Emulator)=>Boolean) {
    profilingCallback = Option(callback)
  }

  def runItem(emulator: Emulator) {
    def t = new Thread(new Runnable() {
      override def run = {
        val isWorkLeft = profilingCallback.get(emulator)
        if (isWorkLeft) runItem(emulator)
      }
    })
    t.start()
  }
}
